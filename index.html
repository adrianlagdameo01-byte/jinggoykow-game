<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Operation Steal Jinggoykow's Heart ğŸ’˜</title>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

<style>
body {
    margin: 0;
    overflow: hidden;
    font-family: 'Press Start 2P', cursive;
    background: black;
    color: white;
    text-align: center;
}

canvas#spaceBG, canvas#fireworksCanvas {
    position: fixed; top:0; left:0; width:100%; height:100%; z-index:-3;
}

.line { opacity: 0; transition: opacity 3s ease; font-size: 1.2em; }
.line1 { color: pink; }
.line2 { color: hotpink; }
.line3 { color: yellow; }
.line4 { color: lightblue; }
.line5 { color: lightgreen; }

.glow { text-shadow:0 0 15px pink,0 0 25px hotpink,0 0 35px red; }

.heart {
    position:absolute;
    font-size:35px;
    cursor:pointer;
    filter: drop-shadow(0 0 10px #ff69b4) drop-shadow(0 0 20px #ff1493);
}

#score, #catchMessage { font-size:18px; margin-top:10px; opacity:1; transition: opacity 1.5s ease; }

#gameOver,#finalScreen,#finalLine,#winBox{ display:none; width:100%; text-align:center; }

#gameOver { position:fixed; bottom:20%; width:100%; }

#gameOverBox {
    display:inline-block;
    background:#111;
    border:2px solid hotpink;
    padding:20px 30px;
    border-radius:15px;
}

#winBox {
    position:fixed;
    bottom:10%;
    left:50%;
    transform:translateX(-50%);
    background:black;
    border:2px solid pink;
    padding:20px 30px;
    border-radius:15px;
    font-size:1.2em;
    color:white;
    opacity:0;
    transition: opacity 0.5s ease;
}

button{
    padding:12px 20px;
    font-size:14px;
    border:none;
    border-radius:25px;
    margin:10px;
    cursor:pointer;
    font-family: 'Press Start 2P', cursive;
}

#yesBtn{ background:white; color:hotpink; display:none; }
#noBtn{ background:black; color:white; position:absolute; display:none; }

.particle{
    position:absolute;
    pointer-events:none;
    font-size:18px;
}

#finalLine{
    font-size:1.3em;
    color:pink;
    text-shadow:0 0 15px pink,0 0 25px hotpink,0 0 35px red;
    opacity:0;
    transition:opacity 3s;
    top:70%;
}
</style>
</head>

<body>

<canvas id="spaceBG"></canvas>
<canvas id="fireworksCanvas"></canvas>

<h1>Operation Steal Jinggoykow's Heart ğŸ’˜</h1>
<p id="catchMessage">Catch 14 hearts to win ğŸ˜Œ</p>
<div id="score">Hearts: 0</div>

<audio id="bgMusic" loop>
  <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3" type="audio/mpeg">
</audio>

<audio id="popSound">
  <source src="https://assets.mixkit.co/sfx/preview/mixkit-bubble-pop-up-alert-notification-2357.mp3" type="audio/mpeg">
</audio>

<div id="gameOver">
    <div id="gameOverBox">
        <h2>ğŸ’” GAME OVER ğŸ’”</h2>
        <p>You missed too many hearts...</p>
        <button onclick="continueGame()">Try Again</button>
    </div>
</div>

<div id="winBox">ğŸ‰ Great Job your Highness! ğŸ‰</div>

<div id="finalScreen">
    <div id="message">
        <div class="line line1">Jinggoykowâ€¦</div>
        <div class="line line2">You caught the hearts â¤ï¸</div>
        <div class="line line3">But honestly?</div>
        <div class="line line4">You already had mine from the beginning.</div>
        <div class="line line5">Do I have yours too? ğŸ’–</div>
    </div>
    <br>
    <button id="yesBtn" onclick="yesClicked()">YES ğŸ’–</button>
    <button id="noBtn">NO ğŸ˜¢</button>
</div>

<div id="finalLine">I'm forever yours Jinggoykow â¤ï¸ğŸ’–ğŸ˜ğŸ¥° Happy Heart's Day! ğŸ’˜ğŸ’</div>

<script>

// --- SPACE BACKGROUND (unchanged) ---
const canvas = document.getElementById('spaceBG');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const stars=[];
for(let i=0;i<150;i++){
    stars.push({x:Math.random()*canvas.width,y:Math.random()*canvas.height,r:Math.random()*1.2,vx:(Math.random()-0.5)/2,vy:(Math.random()-0.5)/2});
}

function drawSpace(){
    ctx.fillStyle="rgba(0,0,0,0.6)";
    ctx.fillRect(0,0,canvas.width,canvas.height);
    for(let s of stars){
        ctx.beginPath();
        ctx.arc(s.x,s.y,s.r,0,Math.PI*2);
        ctx.fillStyle="white";
        ctx.fill();
        s.x+=s.vx; s.y+=s.vy;
        if(s.x<0)s.x=canvas.width;
        if(s.x>canvas.width)s.x=0;
        if(s.y<0)s.y=canvas.height;
        if(s.y>canvas.height)s.y=0;
    }
    requestAnimationFrame(drawSpace);
}
drawSpace();

// --- GAME VARIABLES ---
let score=0, heartsMissed=0, gameStopped=false, gameWon=false;
const music=document.getElementById("bgMusic");
const pop=document.getElementById("popSound");

document.addEventListener("click",()=>{music.volume=0.6; music.play().catch(()=>{});},{once:true});
document.addEventListener("touchstart",()=>{music.volume=0.6; music.play().catch(()=>{});},{once:true});

// --- HEARTS ---
function createHeart(){
    if(gameStopped||gameWon) return;

    const heart=document.createElement("div");
    heart.classList.add("heart");
    heart.innerHTML="â¤ï¸";

    heart.style.left=Math.random()*90+"vw";
    heart.style.top="100vh";
    heart.style.animation="floatUp 5s linear forwards";

    heart.onclick=function(){

        pop.currentTime=0;
        pop.play().catch(()=>{});

        const rect = heart.getBoundingClientRect();
        const centerX = rect.left + rect.width/2;
        const centerY = rect.top + rect.height/2;

        let particleCount = score===13 ? 25 : 12;

        for(let i=0;i<particleCount;i++){
            const p=document.createElement("div");
            p.className="particle";
            p.innerHTML = Math.random()>0.5 ? "ğŸ’–" : "âœ¨";
            p.style.left=centerX+"px";
            p.style.top=centerY+"px";

            const angle=Math.random()*2*Math.PI;
            const distance=Math.random()*(score===13?140:80)+(score===13?80:40);

            p.animate([
                {transform:"translate(-50%,-50%) scale(1)",opacity:1},
                {transform:`translate(${Math.cos(angle)*distance}px,${Math.sin(angle)*distance}px) scale(2.5)`,opacity:0}
            ],{duration:800,easing:"ease-out"});

            document.body.appendChild(p);
            setTimeout(()=>p.remove(),800);
        }

        score++;
        document.getElementById("score").innerText="Hearts: "+score;

        if(score>=14 && !gameWon){
            document.getElementById("catchMessage").style.display="none";
            document.getElementById("score").style.display="none";
            document.getElementById("winBox").style.display="block";
            setTimeout(()=>{document.getElementById("winBox").style.opacity=1;},50);
            setTimeout(()=>{document.getElementById("winBox").style.opacity=0;},3000);
            setTimeout(endGame,3500);
        }

        heart.remove();
    };

    document.body.appendChild(heart);

    setTimeout(()=>{
        if(heart.parentNode){
            heart.remove();
            heartsMissed++;
            if(heartsMissed>=5&&!gameWon) showGameOver();
        }
    },8000);
}

function showGameOver(){
    score=0;
    heartsMissed=0;
    document.getElementById("score").innerText="Hearts: 0";
    gameStopped=true;
    document.getElementById("gameOver").style.display="block";
}

function continueGame(){
    gameStopped=false;
    document.getElementById("gameOver").style.display="none";
}

function endGame(){
    gameWon=true;
    gameStopped=true;
    document.getElementById("finalScreen").style.display="block";
    const lines=document.querySelectorAll(".line");
    lines.forEach((line,i)=>{
        setTimeout(()=>{line.style.opacity=1;line.classList.add("glow");},3000*(i+1));
    });
    setTimeout(()=>{
        document.getElementById("yesBtn").style.display="inline-block";
        document.getElementById("noBtn").style.display="inline-block";
    },3000*(lines.length+1));
}

// NO button behavior unchanged
const noBtn=document.getElementById("noBtn");
function moveNoButton(){
    noBtn.style.left=Math.random()*80+"vw";
    noBtn.style.top=Math.random()*80+"vh";
}
noBtn.addEventListener("mouseover", moveNoButton);
noBtn.addEventListener("click", moveNoButton);
noBtn.addEventListener("touchstart", moveNoButton);

setInterval(createHeart,1150);

</script>
</body>
</html>

